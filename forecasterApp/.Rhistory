RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=c(5,5), linear.output = TRUE)
plot(nn)
summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
df$Age_08_04<-(df$Age_08_04-min(df$Age_08_04))/ (max(df$Age_08_04)-min(df$Age_08_04))
df$KM<-(df$KM -min(df$KM))/(max(df$KM)-min(df$KM))
df$Quarterly_Tax<-(df$Quarterly_Tax-min(df$Quarterly_Tax))/(max(df$Quarterly_Tax)-min(df$Quarterly_Tax))
df$Guarantee_Period<-df$Guarantee_Period/max(df$Guarantee_Period)
df<-na.omit(read.csv('ToyotaCorolla.csv'))
dummy<-fastDummies::dummy_cols(df$Fuel_Type)
df$cng<-dummy$.data_CNG
df$diesel<-dummy$.data_Diesel
df$petrol<-dummy$.data_Petrol
df<-df[,-8]
df$Price<-(df$Price-min(df$Price))/(max(df$Price)-min(df$Price))
df$Age_08_04<-(df$Age_08_04-min(df$Age_08_04))/ (max(df$Age_08_04)-min(df$Age_08_04))
df$KM<-(df$KM -min(df$KM))/(max(df$KM)-min(df$KM))
df$Quarterly_Tax<-(df$Quarterly_Tax-min(df$Quarterly_Tax))/(max(df$Quarterly_Tax)-min(df$Quarterly_Tax))
df$Guarantee_Period<-df$Guarantee_Period/max(df$Guarantee_Period)
#d<-preProcess(df,method="range")
samp<-sample(rownames(df),dim(df)[1]*.6)
train<-df[samp,]
notSamp<-setdiff(rownames(df),samp)
test<-df[notSamp,]
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=2, linear.output = TRUE)
plot(nn)
summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=2, linear.output = TRUE)
plot(nn)
#summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=5, linear.output = TRUE)
plot(nn)
#summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=c(5,5), linear.output = TRUE)
plot(nn)
#summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
nn<-neuralnet(Price~cng+diesel+petrol+Automatic+Doors+Airco+KM+HP+CD_Player+Age_08_04+Quarterly_Tax+Mfr_Guarantee+Guarantee_Period+Automatic_airco+Powered_Windows+Sport_Model+Tow_Bar, data=train, hidden=5, linear.output = TRUE)
plot(nn)
#summary(nn)
pred<-predict(nn,train)
RMSE(pred,train$Price)
pred<-predict(nn, test)
RMSE(pred,test$Price)
setwd("~/")
df<-na.omit(read.csv('TOTALNSA.csv'))
model<-ts(df, start=c(1967,1),end = c(2020,3),frequency = 12)
View(model)
plot(model)
arima(seasonTS, order = c(1,0,0))
df<-na.omit(read.csv('TOTALNSA.csv'))
seasonTS<-ts(df, start=c(1967,1),end = c(2020,3),frequency = 12)
arima(seasonTS, order = c(1,0,0))
df<-na.omit(read.csv('TOTALNSA.csv'))
seasonTS<-ts(df$TOTALNSA, start=c(1967,1),end = c(2020,3),frequency = 12)
arima(seasonTS, order = c(1,0,0))
df<-na.omit(read.csv('TOTALNSA.csv'))
seasonTS<-ts(df$TOTALNSA, start=c(1967,1),end = c(2020,3),frequency = 12)
arima(seasonTS, order = c(1,1,1))
arims<-arima(seasonTS, order = c(1,0,0))
plot(arims)
fore<-forecast::forecast(arims)
View(fore)
fore<-forecast::forecast(arims,h=1)
plot(fore)
df2<-na.omit(read.csv('TOTALSA.csv'))
arima2<-arima(noSeason, order = c(1,0,0))
noSeason<-ts(df2$TOTALSA,start=c(1967,1),end = c(2020,3),frequency = 12)
arima2<-arima(noSeason, order = c(1,0,0))
fore<-forecast::forecast(arima2,h=1)
fore2<-forecast::forecast(arima2,h=1)
plot(fore2)
library(fpp)
dec<-decompose(seasonTS,"additive")
seasAdj<-seasonTS-dec$seasonal
fr<-forecast(ar,h=1)
ar<-arima(seasAdj, order=c(1,0,0))
fr<-forecast(ar,h=1)
plot(fr)
lm<-tslm(seasAdj~trend+I(trend^2))
range=c(min(df$TOTALNSA),max(df$TOTALNSA))
plot(seasAdj,main="Car sales (No Seasonality)",xlab="Time",ylab="Money",ylim=range)+lines(lm$fitted.values,lwd=2)
seasAdj<-seasonTS-dec$seasonal
plot(seasAdj)
fr<-forecast(ar,h=10)
plot(fr)
df<-na.omit(read.csv('TOTALNSA.csv'))
seasonTS<-ts(df$TOTALNSA, start=c(1967,1),end = c(2020,3),frequency = 12)
arims<-arima(seasonTS, order = c(1,0,0))
fore<-forecast::forecast(arims,h=100)
plot(fore)
df2<-na.omit(read.csv('TOTALSA.csv'))
noSeason<-ts(df2$TOTALSA,start=c(1967,1),end = c(2020,3),frequency = 12)
arima2<-arima(noSeason, order = c(1,0,0))
fore2<-forecast::forecast(arima2,h=100)
plot(fore2)
library(fpp)
dec<-decompose(seasonTS,"additive")
seasAdj<-seasonTS-dec$seasonal
ar<-arima(seasAdj, order=c(1,0,0))
fr<-forecast(ar,h=100)
plot(fr)
range=c(min(df$TOTALNSA),max(df$TOTALNSA))
lm<-tslm(seasAdj~trend+I(trend^2))
plot(seasAdj,main="Car sales (No Seasonality)",xlab="Time",ylab="Money",ylim=range)+lines(lm$fitted.values,lwd=2)
shiny::runApp('Cler-it-y')
setwd("~/GitHub/Cler-it-y")
runApp('~/Cler-it-y')
runApp('~/Cler-it-y')
runApp('~/Cler-it-y')
setwd("~/")
df<-read.csv('CanadianWorkHours.csv')
cts<-window(ts(df),start=1966, end=2000)
cts<-ts(df$Hours, start=1966, end=2000)
#cts<-window(ts(df),start=1966, end=2000)
Acf(cts)
library(forecast)
df<-read.csv('CanadianWorkHours.csv')
cts<-ts(df$Hours, start=1966, end=2000)
#cts<-window(ts(df),start=1966, end=2000)
Acf(cts)
#cts<-window(ts(df),start=1966, end=2000)
cor(cts)
#cts<-window(ts(df),start=1966, end=2000)
cor(cts[1,length(cts-1)],cts[2,length(cts)])
library(forecast)
df<-read.csv('CanadianWorkHours.csv')
cts<-ts(df$Hours, start=1966, end=2000)
#cts<-window(ts(df),start=1966, end=2000)
cor(cts[1,length(cts-1)],cts[2,length(cts)])
library(forecast)
df<-read.csv('CanadianWorkHours.csv')
cts<-ts(df$Hours, start=1966, end=2000)
Acf(cts)
samp<-sample(rownames(df),dim(df)[1]*.6)
train<-df[samp,]
notSamp<-setdiff(rownames(df),samp)
test<-df[notSamp,]
df<-read.csv('adult-modified.csv')
head(df)
df$age <- as.numeric(df$age)
View(df)
meanAge= sum(na.omit(df$age))/length(na.omit(df$age))
df$age <- as.numeric(df$age)
meanAge= sum(na.omit(df$age))/length(na.omit(df$age))
df$age[is.na(df$age)]=meanAge
summary(df)
df$education[is.na(df$education)]=meanEd
df$education <- as.numeric(df$education)
meanEd= sum(na.omit(df$education))/length(na.omit(df$education))
df$education[is.na(df$education)]=meanEd
df$hours.per.week <- as.numeric(df$hours.per.week)
meanHours= sum(na.omit(df$hours.per.week))/length(na.omit(df$hours.per.week))
df$hours.per.week[is.na(df$hours.per.week)]=meanHours
View(df)
df=df[(df != '?').all(axis=1)]
df=df[(df != '?')]
df=data.frame(df[(df != '?')])
View(df)
df<-read.csv('adult-modified.csv')
head(df)
df$age <- as.numeric(df$age)
meanAge= sum(na.omit(df$age))/length(na.omit(df$age))
df$age[is.na(df$age)]=meanAge
df$education <- as.numeric(df$education)
meanEd= sum(na.omit(df$education))/length(na.omit(df$education))
df$education[is.na(df$education)]=meanEd
df$hours.per.week <- as.numeric(df$hours.per.week)
meanHours= sum(na.omit(df$hours.per.week))/length(na.omit(df$hours.per.week))
df$hours.per.week[is.na(df$hours.per.week)]=meanHours
df[(df == '?'),] = NULL
df[(df == '?')] = NULL
df[,(df == '?')] = NULL
df[(df == '?'),"workclass"] = NULL
df[(df$workclass == '?'),"workclass"] = NULL
df<-df - df[(df$workclass == '?'),]
df<- df[-(df$workclass == '?'),]
d<- df[,(df$workclass == '?')]
df<-read.csv('adult-modified.csv')
head(df)
df$age <- as.numeric(df$age)
meanAge= sum(na.omit(df$age))/length(na.omit(df$age))
df$age[is.na(df$age)]=meanAge
df$education <- as.numeric(df$education)
meanEd= sum(na.omit(df$education))/length(na.omit(df$education))
df$education[is.na(df$education)]=meanEd
df$hours.per.week <- as.numeric(df$hours.per.week)
meanHours= sum(na.omit(df$hours.per.week))/length(na.omit(df$hours.per.week))
df$hours.per.week[is.na(df$hours.per.week)]=meanHours
d<- df[,(df$workclass == '?')]
d<- df[(df$workclass == '?'),]
df<-except(df,d)
d<- df[-(df$workclass == '?'),]
View(d)
d<- df[-c(df$workclass == '?'),]
df<-read.csv('adult-modified.csv')
head(df)
df$age <- as.numeric(df$age)
meanAge= sum(na.omit(df$age))/length(na.omit(df$age))
df$age[is.na(df$age)]=meanAge
df$education <- as.numeric(df$education)
meanEd= sum(na.omit(df$education))/length(na.omit(df$education))
df$education[is.na(df$education)]=meanEd
df$hours.per.week <- as.numeric(df$hours.per.week)
meanHours= sum(na.omit(df$hours.per.week))/length(na.omit(df$hours.per.week))
df$hours.per.week[is.na(df$hours.per.week)]=meanHours
d<- df[(df$workclass == '?'),]
library(dplyr)
df<- anti_join(df,d)
summary(df)
write.csv(df,file="adultData.csv")
d<-df
train <- sample(d, FALSE, 0.8)
test <- except(d, train)
d2 = read.csv('testing')
d1 = read.csv('adultData.csv')
d2 = read.csv('testing')
d2 = read.csv('testing.csv')
setwd("~/")
d2 = read.csv('training.csv')
d3 = anti_join(d1,d2)
write.csv(d3,file="testing.csv")
head(df)
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
trans<- as(mat, "transactions")
print(mat)
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
print(mat)
mat
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
trans<- as(mat, "transactions")
trans<- as(mat, "transaction")
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
trans<- as(mat, "transaction")
View(dfSorted2)
describe(df)
df.describe()
df.describe
df<-read.csv('Coursetopics.csv')
head(df)
mat<-as.matrix(df[,-1])
trans<- as(mat, "transactions")
rules <- apriori(mat, parameter=list(supp=.2,conf=.6, target="rules"))
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1])
trans<- as(mats, "transactions")
library(arules)
install.packages("arules")
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1])
trans<- as(mats, "transactions")
inspect(trans)
rules <- apriori(trans, parameter=list(supp=.2,conf=.6, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1])
trans<- as(mats, "transactions")
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.2,conf=.6, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1])
trans<- as(mats, "transactions")
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.2,conf=.5, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1])
trans<- as(mats, "transactions")
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.2,conf=.5, target="rules"))
#inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
trans<- as(mats, "transactions");
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.2,conf=.5, target="rules"))
#inspect(head(sort(rules,by="lift"),n=5))
summary(rules)
rules <- apriori(trans, parameter=list(supp=.1,conf=.5, target="rules"))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
trans<- as(mats, "transactions");
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.1,conf=.5, target="rules"))
summary(rules)
#inspect(head(sort(rules,by="lift"),n=5))
trans<- as(mats, "transactions");
View(trans)
View(mat)
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
trans<- as(mats, "transactions");
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.1,conf=.3, target="rules"))
summary(rules)
#inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
trans<- as(mats, "transactions");
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.1,conf=.9, target="rules"))
summary(rules)
#inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
trans<- as(mats, "transactions");
#inspect(trans)
rules <- apriori(trans, parameter=list(supp=.6,conf=.9, target="rules"))
summary(rules)
#inspect(head(sort(rules,by="lift"),n=5))
rules <- apriori(trans, parameter=list(supp=.2,conf=.1, target="rules"))
summary(rules)
print(rules)
head(rules)
inspect(head(sort(rules,by="lift"),n=5))
library(arules)
df<-read.csv('Coursetopics.csv')
head(df)
mats<-as.matrix(df[,-1]);
View(mat)
rules <- apriori(trans, parameter=list(supp=.2,conf=.1, target="rules"))
summary(rules)
inspect(head(sort(rules,by="lift"),n=5))
df<-df[-1,]
mats<-as.matrix(df);
trans<- as(mats, "transactions");
rules <- apriori(trans, parameter=list(supp=.2,conf=.1, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
df<-df[apply(df,1,function(x)!all(x==0)),]
mats<-as.matrix(df);
trans<- as(mats, "transactions");
rules <- apriori(trans, parameter=list(supp=.2,conf=.1, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
rules <- apriori(trans, parameter=list(supp=.4,conf=.4, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
rules <- apriori(trans, parameter=list(supp=.05,conf=.4, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
rules <- apriori(trans, parameter=list(supp=.05,conf=.1, target="rules"))
inspect(head(sort(rules,by="lift"),n=5))
inspect(head(sort(rules,by="lift"),n=8))
inspect(head(sort(rules,by="lift"),n=5))
inspect(head(sort(rules,by="lift"),n=5))
inspect(head(sort(rules,by="lift"),n=6))
setwd("~/GitHub/Milwaukee-Crime-Forecaster")
shiny::runApp('forecasterApp')
runApp('forecasterApp')
data<-read.csv("cleanedData.csv")
summary(data)
df <-read.csv('cleanedData.csv')
install.packages("ks")
df1<-df[df$yearN==input$year,]
df1<-rbind(df1,df[df$monthN==input$month,])
df1<-rbind(df1,df[df$dayN==input$day,])
df <-read.csv('cleanedData.csv')
k<-kde(x=c(df1$x_lng, df1$ylat))
runApp('forecasterApp')
print(summary(k))
detach("package:arules", unload = TRUE)
library(ks)
df <-read.csv('cleanedData.csv')
summary(df)
k<-kde(x=c(df$x_lng, df$ylat))
print(summary(k))
plot(k)
setwd("~/GitHub/Milwaukee-Crime-Forecaster/forecasterApp")
k<-kde(x=as.matrix(df$x_lng, df$ylat))
print(summary(k))
plot(k)
k<-kde(x=as.matrix(c(df$x_lng, df$ylat)))
print(summary(k))
plot(k)
k<-kde(df$x_lng, df$ylat)
print(summary(k))
plot(k)
data<-c(df$x_lng,df$y_lat)
data<-as.matrix(df$x_lng,df$y_lat)
View(data)
data<-as.matrix(c(df$x_lng,df$y_lat))
View(data)
data<-as.matrix(c(df$x_lng,df$y_lat),ncol=2)
View(data)
library(ks)
df <-read.csv('cleanedData.csv')
summary(df)
data<-as.matrix(c(df$x_lng,df$y_lat),ncol=2)
df <-read.csv('cleanedData.csv')
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
k<-kde(x=c(df1$x_lng,df1$y_lat))
plot(x=df1$x_lng, y=df1$y_lat)
df <-na.omit(read.csv('cleanedData.csv'))
df <- df[df$y_lat>42.5]
df <- df[df$y_lat>42.5,]
df<- df[df$y_lat<43.5,]
df<-df[df$x_lng>-89,]
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
plot(x=df1$x_lng, y=df1$y_lat)
df<-df[df$x_lng>-88.11,]
plot(x=df1$x_lng, y=df1$y_lat)
df<-df[df$x_lng>-88.11,]
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
plot(x=df1$x_lng, y=df1$y_lat)
df<- df[df$y_lat<43.2,]
df<-df[df$x_lng>-88.11,]
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
k<-kde(x=c(df1$x_lng,df1$y_lat))
print(summary(k))
plot(x=df1$x_lng, y=df1$y_lat)
df <- df[df$y_lat>42.9,]
df<- df[df$y_lat<43.2,]
df<-df[df$x_lng>-88.11,]
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
k<-kde(x=c(df1$x_lng,df1$y_lat))
print(summary(k))
plot(x=df1$x_lng, y=df1$y_lat)
df<-df[df$x_lng>-88.08,]
summary(df)
year=2012
month=5
day=22
df1<-df[df$yearN==year,]
df1<-rbind(df1,df[df$monthN==month,])
df1<-rbind(df1,df[df$dayN==day,])
k<-kde(x=c(df1$x_lng,df1$y_lat))
print(summary(k))
plot(x=df1$x_lng, y=df1$y_lat)
ggplot(df1,aes(x=x_lng,y=y_lat))+geom_point()
library(ggplot2)
ggplot(df1,aes(x=x_lng,y=y_lat))+geom_point()
ggplot(df1,aes(x=x_lng,y=y_lat,color=j_finding))+geom_point()
runApp()
